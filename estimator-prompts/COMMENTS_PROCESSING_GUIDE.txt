COMMENTS_PROCESSING_GUIDE

SHORT SUMMARY

This document defines how AI must read, interpret, and apply comments from Companies, Vessels, and Persons during scoring and offer/message generation.

The comments contain expert, non-structured knowledge:
â€“ cargo preferences
â€“ geographic restrictions
â€“ intake data
â€“ technical limitations
â€“ behavioral and communication notes

AI must extract structured meaning from unstructured comments, filter them by relevance to the current cargo, resolve contradictions, and incorporate them into:

Regional scoring
Cargo scoring
Intake evaluation
Offer text reasoning
Communication tone and formatting

The guide also defines keyword detection patterns, priority order (vessel > person > company), parsing rules, and examples for every scoring criterion.

HOW TO USE THIS DOCUMENT (INSTRUCTIONS)

Feed all three comment blocks to AI

company_comments

vessel_comments

person_comments

AI must parse them into structured meaning
Use the keyword groups defined in the document:

specialization

geographic preferences

cargo preferences

technical info

behavioral notes

Filter only relevant parts
AI should keep only the parts that match:

ports / countries / regions of this cargo

cargo type

draft / gear needs

communication style for messaging

Resolve conflicts using defined priority:

Vessel comments

Person comments

Company comments

Formal preferences from UI
AI must mention the conflict in reasoning if necessary.

Apply extracted info to scoring

Regional preferences â†’ regional scoring

Cargo preferences â†’ cargo scoring

Intake comments â†’ override calculated intake

Technical limits â†’ adjust feasibility

Behavioral info â†’ message personalization

Apply comments to offer text generation

Highlight good matches (â€œYou specialize in Black Sea grainsâ€¦â€)

Address concerns (â€œI know you avoid Egypt routesâ€¦â€)

Mention technical readiness (â€œYour gear is suitableâ€¦â€)

Adjust communication tone (â€œPrefers short messages, WhatsAppâ€¦â€)

Include comment summary in AI prompt
Use the template block from the document under PROMPT ADDITIONS.

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# COMMENTS PROCESSING GUIDE
# VK Charts AI Scoring System - Extension
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# ĞšĞ°Ğº AI Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ñ‚ÑŒ Ğ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ comments Ğ¸Ğ· ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞµĞº
# ĞºĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸ Ğ¸ ÑÑƒĞ´Ğ½Ğ° Ğ¿Ñ€Ğ¸ scoring Ğ¸ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ²
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

version: "1.0"
date: "2024-11-28"
priority: "CRITICAL - ĞšĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ¸ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ ĞºĞ»ÑÑ‡ĞµĞ²ÑƒÑ ÑĞºÑĞ¿ĞµÑ€Ñ‚Ğ½ÑƒÑ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# OVERVIEW
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

purpose: |
  Company comments Ğ¸ Vessel comments ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ ÑĞºÑĞ¿ĞµÑ€Ñ‚Ğ½Ñ‹Ğµ Ğ·Ğ½Ğ°Ğ½Ğ¸Ñ Ğ¾:
  - ĞŸÑ€ĞµĞ´Ğ¿Ğ¾Ñ‡Ñ‚ĞµĞ½Ğ¸ÑÑ… Ğ¸ ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸
  - ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸ÑÑ… Ğ¸ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°Ñ…
  - ĞÑĞ¾Ğ±ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑÑ… Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹
  - Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¼ Ğ¿Ğ¾Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğ¸
  - Ğ¢ĞµÑ…Ğ½Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ğ´ĞµÑ‚Ğ°Ğ»ÑÑ…
  
  AI ĞĞ‘Ğ¯Ğ—ĞĞ ÑƒÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°Ñ‚ÑŒ ÑÑ‚Ğ¸ ĞºĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ¸ Ğ¿Ñ€Ğ¸:
  - Scoring Ğ¿Ğ¾ Ğ²ÑĞµĞ¼ ĞºÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸ÑĞ¼
  - Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ offer texts
  - ĞÑ†ĞµĞ½ĞºĞµ compatibility
  - Ğ¤Ğ¾Ñ€Ğ¼ÑƒĞ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¸ reasoning

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# DATA SOURCES
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

data_sources:
  
  company_comments:
    database_field: "companies.comments"
    example: "spec: turkish domestic cargoes, Italy ok, greece ok, eu ok, cvb ok, continent ok"
    
    typical_content:
      - "Specialization patterns"
      - "Geographic preferences"
      - "Cargo type preferences"
      - "Communication preferences"
      - "Payment history"
      - "Reliability notes"
      - "Special requirements"
      
  vessel_comments:
    database_field: "vessels.comments"
    example: "Real intake: Corn, draft 7m, Izmail = 4800t"
    
    typical_content:
      - "Technical specifications"
      - "Performance data"
      - "Intake records"
      - "Port restrictions"
      - "Maintenance issues"
      - "Crew information"
      - "Historical behavior"
      
  person_comments:
    database_field: "people.comments"
    example: "Prefers WhatsApp communication, responds within 1 hour"
    
    typical_content:
      - "Communication style"
      - "Response patterns"
      - "Decision-making authority"
      - "Language preferences"
      - "Time zone considerations"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# PARSING STRATEGY
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

parsing_strategy:
  
  principle: "Extract structured information from unstructured text"
  
  step_1_keyword_detection:
    description: "Identify key patterns and keywords"
    
    patterns:
      
      specialization:
        keywords: ["spec:", "specializes", "mainly", "mostly"]
        examples:
          - "spec: turkish domestic cargoes"
          - "specializes in grain trades"
          - "mainly works Black Sea"
          
      geographic_preferences:
        keywords: ["ok", "no", "cannot", "avoids", "prefers"]
        examples:
          - "Italy ok, greece ok, eu ok"
          - "no Egypt"
          - "cannot work Libya"
          - "avoids Turkey"
          
      cargo_preferences:
        keywords: ["cargo:", "loads", "carries", "no bulk"]
        examples:
          - "cargo: grain only"
          - "loads steel products"
          - "no bulk fertilizers"
          
      technical_info:
        keywords: ["intake:", "draft", "gear", "speed"]
        examples:
          - "Real intake: Wheat 5200t"
          - "draft restricted to 7m"
          - "geared vessel"
          
      behavioral_notes:
        keywords: ["always", "never", "typically", "usually"]
        examples:
          - "always asks for freight first"
          - "never responds weekends"
          - "typically ballasts to Black Sea"
          
  step_2_relevance_filtering:
    description: "Extract only information relevant to current cargo"
    
    relevance_rules:
      geographic:
        - "If comment mentions cargo loading/discharge region â†’ RELEVANT"
        - "If comment mentions country â†’ RELEVANT"
        - "If general restriction â†’ RELEVANT"
        
      cargo_type:
        - "If comment mentions cargo type â†’ RELEVANT"
        - "If comment about capacity â†’ RELEVANT"
        - "If technical restrictions â†’ RELEVANT"
        
      communication:
        - "Always relevant for offer text generation"
        
  step_3_conflict_resolution:
    description: "Handle contradictions between sources"
    
    priority_order:
      1: "Vessel comments (most specific)"
      2: "Person comments (behavioral patterns)"
      3: "Company comments (general policies)"
      4: "Formal preferences (UI settings)"
      
    example_conflict:
      scenario:
        company_comment: "spec: turkish domestic cargoes"
        vessel_settings: "Specializes: Black Sea international"
        
      resolution:
        selected: "Vessel settings (formal)"
        but_mention: "Note company comment in reasoning"
        explanation: "Formal settings override, but acknowledge pattern"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# INTEGRATION WITH SCORING CRITERIA
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

integration_by_criterion:
  
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # CRITERION 2: REGIONAL PREFERENCES
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  
  criterion_2_regional:
    
    comment_impact: "HIGH - Direct geographic information"
    
    parsing_examples:
      
      example_1:
        comment: "spec: turkish domestic cargoes, Italy ok, greece ok, eu ok, cvb ok, continent ok"
        
        extracted:
          specializes:
            - "Turkey domestic"
            
          acceptable:
            - "Italy"
            - "Greece"
            - "EU"
            - "CVB (Constanta-Varna-Burgas)"
            - "Continent (North Europe)"
            
          not_mentioned:
            - "Egypt"
            - "Libya"
            - "Far East"
            
        scoring_impact:
          if_cargo_turkey: "+15 (specializes)"
          if_cargo_italy: "+10 (ok)"
          if_cargo_greece: "+10 (ok)"
          if_cargo_egypt: "0 (not mentioned, neutral)"
          if_cargo_libya: "0 (not mentioned, neutral)"
          
      example_2:
        comment: "no Egypt, Libya ok but slow response, Black Sea excellent"
        
        extracted:
          cannot_work:
            - "Egypt"
            
          acceptable_with_notes:
            - "Libya (but owner slow to respond)"
            
          excellent:
            - "Black Sea"
            
        scoring_impact:
          if_cargo_egypt: "-35 (cannot work)"
          if_cargo_libya: "+5 (ok but flag communication issue)"
          if_cargo_black_sea: "+20 (excellent)"
          
      example_3:
        comment: "Turkish flag, cannot call Ukrainian ports due to current restrictions"
        
        extracted:
          geopolitical_restriction:
            - "Turkish flag"
            - "Cannot call Ukraine"
            
        scoring_impact:
          if_cargo_ukraine: "-50 (IMPOSSIBLE due to flag restriction)"
          offer_text: "SKIP - Do not send offer for Ukrainian ports"
          
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # CRITERION 3: CARGO PREFERENCES
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  
  criterion_3_cargo:
    
    comment_impact: "HIGH - Direct cargo type information"
    
    parsing_examples:
      
      example_1:
        comment: "grain only, no fertilizers, steel ok occasionally"
        
        extracted:
          specializes:
            - "Grain"
            
          cannot_work:
            - "Fertilizers"
            
          occasional:
            - "Steel products"
            
        scoring_impact:
          if_cargo_wheat: "+18 (grain only = strong preference)"
          if_cargo_fertilizers: "-30 (no fertilizers)"
          if_cargo_steel: "+5 (ok occasionally = lukewarm)"
          
      example_2:
        comment: "coils require special dunnage, bagged cargoes preferred"
        
        extracted:
          technical_requirement:
            - "Coils need dunnage"
            
          preference:
            - "Bagged cargoes preferred"
            
        scoring_impact:
          if_cargo_coils: "+0 but NOTE in offer: 'Are you equipped with dunnage?'"
          if_cargo_bagged_wheat: "+12 (preferred)"
          
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # CRITERION 4: LAST PORTS
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  
  criterion_4_lastports:
    
    comment_impact: "MEDIUM - Context for statistics"
    
    parsing_examples:
      
      example_1:
        comment: "historically worked Egypt routes, but stopped since 2023"
        statistics: "Egypt: 45 visits (15%)"
        
        interpretation:
          statistics_show: "High familiarity (15%)"
          comment_reveals: "Pattern changed recently"
          
        scoring_impact:
          base_score: "+12 (high historical familiarity)"
          adjustment: "-7 (but stopped working there)"
          final: "+5 (acknowledge history but recent avoidance)"
          
      example_2:
        comment: "new vessel, using company patterns"
        statistics: "No vessel history"
        
        interpretation:
          fallback: "Use company-level statistics"
          
        scoring_impact:
          use_company_stats: true
          note_in_text: "Vessel is new but company knows the route well"
          
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # CRITERION 5: INTAKE
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  
  criterion_5_intake:
    
    comment_impact: "CRITICAL - Manual intake overrides calculation"
    
    parsing_examples:
      
      example_1:
        comment: "Real intake: Corn, draft 7m, Izmail = 4800t"
        cargo: "Wheat 5000t, Izmail â†’ Egypt"
        
        parsing:
          regex: "Real intake:\\s*(\\w+),\\s*draft\\s*([\\d.]+)m,\\s*(\\w+)\\s*=\\s*(\\d+)t"
          extract:
            cargo_match: "Corn" (similar to Wheat - grain)
            draft: "7m"
            port_match: "Izmail" (EXACT match)
            intake: "4800t"
            
        scoring_impact:
          use_manual: true
          intake_value: 4800
          vs_cargo: 5000
          fit: "tight" (4800 < 5000)
          score: "-10 (insufficient capacity)"
          
      example_2:
        comment: "Shallow draft, max 6.5m in fresh water"
        port: "Izmail (freshwater, 7m limit)"
        
        interpretation:
          port_allows: "7m"
          vessel_max: "6.5m"
          restriction: "Vessel draft more restrictive than port"
          
        scoring_impact:
          recalculate: "Use 6.5m as effective draft limit"
          note: "Vessel has tighter draft restriction than port"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# OFFER TEXT GENERATION WITH COMMENTS
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

offer_text_integration:
  
  principle: "Use comments to personalize and strengthen offer"
  
  techniques:
    
    acknowledge_specialization:
      comment: "spec: turkish domestic cargoes, Italy ok"
      cargo: "Turkey â†’ Italy"
      
      offer_text: |
        "I know you specialize in Turkish domestic trades and also
         work Italy routes - this cargo is right in your wheelhouse."
         
    address_concerns:
      comment: "slow payers in Egypt, prefer advance payment"
      cargo: "Discharge Egypt"
      
      offer_text: |
        "I understand you prefer advance payment arrangements.
         This charterer has good payment record and can discuss terms."
         
    highlight_fit:
      comment: "grain only, no fertilizers"
      cargo: "Wheat"
      
      offer_text: |
        "Pure grain cargo - exactly what your vessel is specialized for."
        
    technical_confirmation:
      comment: "geared vessel, can handle bagged cargoes"
      cargo: "Bagged wheat"
      
      offer_text: |
        "Bagged cargo needs vessel's gear - you're equipped for this."
        
    avoid_mismatch:
      comment: "no Egypt"
      cargo: "Discharge Egypt"
      
      offer_text: |
        "I know you typically don't work Egypt routes, but wanted to
         check if anything has changed or if this particular cargo
         might be interesting given [strong point]."

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# AI PROMPT ADDITIONS
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

prompt_template_addition:
  
  section: |
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    EXPERT COMMENTS AND NOTES
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    Company Comments:
    {company_comments}
    
    Vessel Comments:
    {vessel_comments}
    
    Person Comments:
    {person_comments}
    
    ---
    
    IMPORTANT: These comments contain expert knowledge from past
    interactions and manual observations. Extract and apply ONLY
    the information RELEVANT to current cargo:
    
    1. Geographic preferences â†’ Regional scoring
    2. Cargo preferences â†’ Cargo type scoring
    3. Technical specs â†’ Intake calculation
    4. Behavioral patterns â†’ Offer text tone
    5. Communication style â†’ Message formatting
    
    If comment contradicts formal settings, mention both but
    prioritize formal settings for scoring. Use comments to
    add context and nuance to explanations.

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# EXAMPLES OF COMMENT PROCESSING
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

processing_examples:
  
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # EXAMPLE 1: FULL PARSING
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  
  example_1_imamoglu:
    
    raw_data:
      company_comment: "spec: turkish domestic cargoes, Italy ok, greece ok, eu ok, cvb ok, continent ok"
      vessel_comment: null
      person_comment: null
      
    cargo:
      type: "Wheat"
      load: "Izmail, Ukraine"
      discharge: "Egypt Mediterranean"
      
    parsing_output:
      
      specialization:
        primary: "Turkish domestic cargoes"
        relevance_to_cargo: "NOT RELEVANT (cargo is Ukraine â†’ Egypt)"
        
      acceptable_regions:
        - region: "Italy"
          relevance: "NOT RELEVANT"
        - region: "Greece"
          relevance: "NOT RELEVANT"
        - region: "EU"
          relevance: "NOT RELEVANT"
        - region: "CVB (Constanta-Varna-Burgas)"
          relevance: "PARTIALLY RELEVANT (loading area nearby)"
        - region: "Continent (North Europe)"
          relevance: "NOT RELEVANT"
          
      not_mentioned:
        - region: "Ukraine"
          interpretation: "No explicit preference"
        - region: "Egypt"
          interpretation: "No explicit preference"
        - region: "Black Sea"
          interpretation: "No explicit preference"
          
    scoring_impact:
      
      regional_preferences:
        base_score: 10  # Neutral (no strong match)
        reasoning: |
          "Company specializes in Turkish domestic trades, which is
           not relevant to this cargo. Loading from Ukraine and
           discharging in Egypt are not mentioned in their typical
           areas. CVB region (nearby) is listed as 'ok', suggesting
           vessel can work broader Black Sea area.
           
           Score: 10/20 (neutral - not their specialty but acceptable)"
           
      offer_text_adjustment: |
        "I know you primarily work Turkish domestic cargoes, but this
         Black Sea to Med route is adjacent to your CVB operations
         and might be interesting given..."
         
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # EXAMPLE 2: INTAKE FROM COMMENTS
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  
  example_2_manual_intake:
    
    raw_data:
      vessel_comment: "Real intake: Wheat 5200t, Odessa summer. Real intake: Corn, draft 7m, Izmail = 4800t"
      
    cargo:
      type: "Wheat"
      quantity: 5000
      load: "Izmail"
      
    parsing_output:
      
      intakes_found:
        - intake_1:
            cargo: "Wheat"
            quantity: 5200
            port: "Odessa"
            conditions: "summer"
            match_quality: "PARTIAL (same cargo type, different port)"
            
        - intake_2:
            cargo: "Corn"
            quantity: 4800
            draft: "7m"
            port: "Izmail"
            match_quality: "GOOD (same port, similar cargo - grain)"
            
      selected_intake:
        value: 4800
        source: "intake_2"
        reason: "Better port match (Izmail), grain cargo similar"
        
    scoring_impact:
      
      intake_assessment:
        vessel_capacity: 4800
        cargo_requirement: 5000
        ratio: 0.96  # 4800/5000
        category: "tight_fit"
        score: "-10 (insufficient by 200t)"
        
        reasoning: |
          "Based on manual intake record, vessel loaded 4800t of corn
           in Izmail at 7m draft. Current cargo requires 5000t wheat.
           This is a tight fit with 4% shortfall.
           
           Options:
           1. Request cargo reduction to 4800t
           2. Verify if wheat stowage allows slightly higher intake
           3. Check if summer draft allows more
           
           Score: 10/20 (tight capacity)"
           
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # EXAMPLE 3: COMMUNICATION STYLE
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  
  example_3_communication:
    
    raw_data:
      person_comment: "Prefers WhatsApp, responds quickly during Turkish business hours, speaks English but prefers short messages"
      
    offer_adjustments:
      
      channel_priority:
        primary: "WhatsApp"
        secondary: "Email"
        
      message_style:
        length: "Short, concise"
        language: "Simple English"
        timing: "Turkish business hours (GMT+3)"
        
      offer_text_whatsapp: |
        "Hi Birol! ğŸ‘‹
        
        Got wheat cargo for NECIBE IMAMOGLU:
        ğŸŒ¾ 6500t Wheat
        ğŸ“ Izmail â†’ Egypt Med
        ğŸ“… December
        
        Your vessel in Marmara - good position!
        
        Interested? What's your freight idea?
        
        /Vitaly"
        
      offer_text_email: |
        Subject: Wheat 6500t Izmail-Egypt | NECIBE IMAMOGLU | Dec
        
        Hi Birol,
        
        Quick cargo offer for NECIBE IMAMOGLU:
        
        - 6,500t Wheat
        - Izmail â†’ Egypt Med
        - December laycan
        
        Vessel's current Marmara position works well.
        
        Let me know if interested and your freight idea.
        
        Thanks,
        Vitaly

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# EDGE CASES
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

edge_cases:
  
  contradictory_comments:
    scenario:
      company: "no Egypt"
      vessel: "Egypt ok if good rate"
      
    resolution:
      priority: "Vessel comment (more specific)"
      score_impact: "-15 (company policy) + 10 (vessel exception) = -5"
      reasoning: "Company generally avoids Egypt, but this vessel willing if rate is good"
      offer_text: "I know company typically doesn't work Egypt, but understand your vessel makes exceptions for good rates. This cargo pays well..."
      
  outdated_comments:
    scenario:
      comment: "no Libya (date: 2022-06-15)"
      current_date: "2024-11-28"
      
    resolution:
      approach: "Mention but verify"
      score_impact: "-20 (historical avoidance)"
      offer_text: "I see from past notes you avoided Libya routes, but that was 2+ years ago. Has policy changed? This cargo might be worth reconsidering..."
      
  ambiguous_comments:
    scenario:
      comment: "ok sometimes"
      
    resolution:
      interpretation: "Neutral to slightly positive"
      score_impact: "+5 (lukewarm acceptance)"
      ai_note: "Comment is vague - treat as neutral with slight positive bias"
      
  multiple_comments:
    scenario:
      comments: "grain only; no fertilizers; steel ok; marble occasionally; cement yes"
      
    resolution:
      parse_all: true
      create_list:
        specializes: ["grain", "cement"]
        acceptable: ["steel"]
        occasional: ["marble"]
        cannot_work: ["fertilizers"]

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# IMPLEMENTATION CHECKLIST
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

implementation:
  
  laravel_service:
    class: "CommentProcessorService"
    
    methods:
      - parseComments(string $comments): array
      - extractRelevantInfo(array $parsed, Cargo $cargo): array
      - applyToScoring(array $info, array $scores): array
      - generateOfferAdjustments(array $info): string
      
  ai_prompt_builder:
    additions:
      - "Include ALL comments in prompt"
      - "Add instruction to extract relevant info"
      - "Emphasize comment priority over generic rules"
      - "Request explanation of how comments influenced score"
      
  validation:
    tests:
      - "Parse complex multi-region comments"
      - "Handle contradictory information"
      - "Extract intake data correctly"
      - "Apply relevance filtering"
      
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SUMMARY
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

summary:
  
  key_principles:
    1: "Comments contain expert knowledge - ALWAYS consider"
    2: "Extract ONLY relevant information for current cargo"
    3: "Vessel comments > Person comments > Company comments > Formal settings"
    4: "Use comments to personalize offer texts"
    5: "When in doubt, mention comment in reasoning"
    
  ai_responsibilities:
    - "Parse unstructured text intelligently"
    - "Filter for relevance"
    - "Resolve conflicts logically"
    - "Apply to scoring with explanation"
    - "Incorporate into offer text naturally"
    
  quality_indicators:
    good_processing:
      - "AI mentions relevant comment in reasoning"
      - "Scoring adjusted based on comment"
      - "Offer text acknowledges comment info"
      
    poor_processing:
      - "AI ignores available comments"
      - "Uses comment info that's not relevant"

      - "Contradicts comment without explanation"

