================================================================================
READINESS / ETA TO LOADING PORT SCORING — P7
Version: 3.0
Last updated: 2026-02-07
================================================================================

PURPOSE:
  Score how well the vessel's availability timing matches the cargo laycan.
  Integrates draught analysis to determine if vessel needs operations buffer.

SCORE RANGE: [0, 10]
ALWAYS ACTIVE: max_score = 10

================================================================================
STEP 1 — DETERMINE VESSEL READY DATE
================================================================================

  Use vessel_location_determination.txt logic:
  
  A) Vessel is OPEN with a date:
     vessel_ready = stated opening date
     
  B) Vessel has destination + ETA:
     Perform draught analysis:
     
     If BALLAST (draught_ratio < 0.65):
       vessel_ready = ETA to destination
       Note: "Vessel appears in ballast — using ETA without operations buffer.
              Recommend confirming availability with owner."
              
     If LADEN (draught_ratio >= 0.65):
       vessel_ready = ETA to destination + 7 days
       Note: "Vessel appears laden — adding 7 days operations buffer 
              (discharge + preparation)."
              
     If OVER_DRAFT (current > max):
       vessel_ready = ETA + 7 days (conservative, treat as laden)
       Note: "Draught data anomaly — treating as laden with +7 days buffer."

  C) Vessel has no clear ETA:
     Estimate based on current position + sailing time to cargo load port
     confidence = "low"

================================================================================
STEP 2 — CALCULATE GAP
================================================================================

  gap = vessel_ready - cargo_layday (start of laycan)
  
  Positive gap = vessel is late (arrives AFTER layday)
  Negative gap = vessel is early (arrives BEFORE layday)
  Zero gap = perfect timing

================================================================================
STEP 3 — SCORING MATRIX
================================================================================

  gap ≤ -7 days (very early):
    score = 4/10
    Note: Vessel idle too long waiting for laycan, owner may lose interest
    offer_hint: "Vessel ready much earlier than laycan — suggest flexibility 
                 on dates or mention filler cargo opportunity."

  gap = -6 to -3 days (early):
    score = 7/10
    Note: Slight wait but manageable
    offer_hint: "Vessel ready a few days early — timing works, mention 
                 flexibility on laycan if possible."

  gap = -2 to +1 days (ideal window):
    score = 10/10
    Note: Perfect timing match
    offer_hint: "Timing aligns perfectly — highlight this in the opening."

  gap = +2 to +3 days (slightly late):
    score = 7/10
    Note: Acceptable if charterer is flexible
    offer_hint: "Timing slightly tight — mention if there's flexibility 
                 on laycan extension."

  gap = +4 to +5 days (late):
    score = 4/10
    Note: Risky, may miss canceling date
    offer_hint: "Timing is tight — only offer if laycan may extend or 
                 vessel can speed up."

  gap = +6 to +7 days (very late):
    score = 2/10
    Note: Likely misses canceling, but not impossible
    offer_hint: "Vessel likely misses canceling — only offer if confirmed 
                 laycan extension possible."

  gap > +7 days (past canceling):
    score = 0/10
    decision = BLOCK
    offer_hint: "Vessel cannot meet laycan — do not offer unless laycan 
                 extension is confirmed."

================================================================================
SPECIAL CASES
================================================================================

  BALLAST QUESTION:
    When vessel is determined to be in ballast heading somewhere:
    - Score using ETA (without +7 days)
    - Add question to offer: confirm if vessel is fixed or open
    - If vessel turns out to be fixed → she's not available anyway
    - If vessel is positioning → she's available sooner
    
    offer_hint includes: "Vessel appears in ballast — confirm with owner 
      if she's proceeding for loading or available for redirection."

  NO ETA AVAILABLE:
    - Estimate sailing time from current position to load port
    - Use average speed (10-12 knots for general cargo)
    - Add 1 day port entry buffer
    - Score with low confidence
    
  VESSEL AT ANCHOR / MOORED (no clear next destination):
    - If at load port area → vessel_ready = today/tomorrow
    - If at other port → estimate sailing time
    - Check if waiting for cargo or waiting for berth

================================================================================
EXAMPLES
================================================================================

  Example 1: Laden vessel
    Vessel heading Ravenna, ETA Feb 13
    current_draught = 8.8m, max_draft = 8.6m → LADEN (over_draft)
    vessel_ready = Feb 13 + 7 = Feb 20
    Cargo layday = Feb 5, canceling = Feb 10
    gap = Feb 20 - Feb 5 = +15 days → score = 0/10, BLOCK
    offer_hint: "Vessel cannot meet laycan — opens 10+ days after canceling."

  Example 2: Ballast vessel  
    Vessel heading Mersin, ETA Feb 10
    current_draught = 2.1m, max_draft = 5.2m → BALLAST
    vessel_ready = Feb 10 (no buffer)
    Cargo layday = Feb 8, canceling = Feb 15
    gap = Feb 10 - Feb 8 = +2 days → score = 7/10
    offer_hint: "Timing works if vessel is available. Confirm ballast status."

  Example 3: Open vessel
    Vessel open Constanta Feb 12
    vessel_ready = Feb 12
    Cargo layday = Feb 14, canceling = Feb 20
    gap = Feb 12 - Feb 14 = -2 days → score = 10/10
    offer_hint: "Timing aligns perfectly — lead with this."

================================================================================
