# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# P2A: PSC PORT ACCESSIBILITY SCORING
# VK Charts AI - Port State Control Based Vessel-Port Matching  
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# PURPOSE: 
# Determine if a vessel with certain PSC (Port State Control) status
# can enter a port without high risk of detention, considering the
# vessel's technical/safety record and port's PSC enforcement severity.
#
# SCORE RANGE: 0-20 points
#
# KEY PRINCIPLE:
# Vessels with poor PSC status AVOID ports with strict PSC enforcement
# because detention risk = lost time and money. This scoring reflects
# real shipowner behavioral patterns.
#
# CROSS-VALIDATION ENHANCEMENT:
# Uses P4 (Last Ports) historical patterns to validate PSC status.
# Frequent calls to strict PSC ports confirm GOOD/MEDIUM status.
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

version: "1.1"
last_updated: "2026-01-16"
author: "VK Charts AI Team"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# DATA SOURCES
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

equasis_data_fields:
  required:
    - "Paris MOU status (White/Grey/Black)"
    - "Tokyo MOU status (White/Grey/Black)" 
    - "USCG status (White/Grey/Black)"
    - "Detention rate (% of inspections resulting in detention)"
    - "Overview text (contains detention history)"
    - "IMO number (for sanctions verification)"
  
  optional_bonus_factors:
    - "Classification Society name (IACS vs non-IACS)"
    - "P&I Club name (International Group vs others)"
    - "Vessel age (affects PSC targeting probability)"
    - "Recent detention dates and deficiency details"
  
  cross_validation_data:
    from_p4_last_ports:
      - "Historical port call patterns (% by region)"
      - "Frequency of calls to strict PSC countries"
      - "Recent port history (last 12-24 months)"
    
    purpose: |
      Use Last Ports data to validate PSC assessment.
      Vessels that regularly call strict PSC ports (Italy, France, Germany)
      must have GOOD or MEDIUM PSC status - they couldn't sustain regular
      calls with Black status (would face constant detentions).

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# SCORING PRINCIPLE
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

scoring_principle: |
  P2A Score = Vessel PSC Status Ã— Port PSC Severity
  
  Key Logic:
  â€¢ Vessels with GOOD PSC status â†’ can go anywhere
  â€¢ Vessels with POOR PSC status â†’ AVOID strict ports, PREFER lax ports
  â€¢ This reflects real shipowner behavior (avoiding detention = saving time/money)
  
  Cross-Validation Enhancement:
  â€¢ Historical port patterns (P4) validate PSC assessment
  â€¢ Regular EU port calls â†’ confirms GOOD/MEDIUM status
  â€¢ Contradictions â†’ flag for manual review

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# VESSEL PSC STATUS CLASSIFICATION
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

vessel_psc_status:
  
  GOOD:
    definition: "Clean PSC record, can enter any port"
    conditions:
      - "Paris MOU = White"
      - "OR (Paris MOU = Grey AND detention_rate < 3%)"
      - "No detentions in last 12 months"
    characteristics: "Low PSC risk, accepted at all ports"
    examples:
      - "Paris MOU: White, Detention rate: 1.8%"
      - "Paris MOU: Grey, Detention rate: 2.5%, no recent detentions"
  
  MEDIUM:
    definition: "Some PSC issues, will avoid strict ports when possible"
    conditions:
      - "Paris MOU = Grey AND detention_rate 3-8%"
      - "1-2 detentions in last 24 months (now resolved)"
    characteristics: "Moderate PSC risk, prefers moderate ports"
    examples:
      - "Paris MOU: Grey, Detention rate: 5.0%"
      - "1 detention 18 months ago, deficiencies cleared"
  
  POOR:
    definition: "Significant PSC problems, actively seeks lax PSC ports"
    conditions:
      - "Paris MOU = Black"
      - "OR detention_rate > 8%"
      - "OR 2+ detentions in last 36 months"
    characteristics: "High PSC risk, strongly PREFERS lax enforcement"
    examples:
      - "Paris MOU: Black, Detention rate: 11.1%"
      - "3 detentions in last 24 months"
  
  BANNED:
    definition: "Vessel banned from specific MOU region"
    conditions:
      - "Paris MOU: 3 detentions in 24-36 months (depending on flag)"
      - "USCG: 3 detentions in 12 months"
      - "Jumped detention (left port before clearance)"
    impact: "ABSOLUTE BLOCK for entire MOU region"
  
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  validation_using_historical_patterns:
    description: "Cross-validate PSC status using P4 Last Ports data"
    
    principle: |
      Vessel's historical port calling patterns serve as indirect 
      PSC status validation. Frequent successful calls to strict PSC 
      ports indicate GOOD or MEDIUM PSC status.
      
      Logic: Vessel with POOR status (Paris Black) CANNOT sustain 
      regular calls to Italy/France/Germany - would face frequent 
      detentions and be denied entry.
    
    positive_validation:
      if_last_ports_shows:
        strict_psc_calls:
          - "Regular calls to Italy, France, Greece, Germany, Netherlands"
          - "Percentage: >20% of total port calls"
          - "Pattern: Consistent over 12-24 months"
        
        examples:
          - "35% calls in EU (Italy 12%, Germany 8%, Netherlands 6%)"
          - "40% calls in strict PSC regions (EU 30%, Japan 5%, Singapore 5%)"
      
      then_vessel_likely_has:
        psc_status: "GOOD or MEDIUM (NOT Poor)"
        reasoning: |
          Cannot regularly call strict PSC ports with Black status.
          Historical pattern confirms vessel can access:
          - Most European ports (including strict ones)
          - Turkish ports (moderate PSC)
          - Ukrainian ports (moderate PSC)
          - Arab ports (moderate/lax PSC)
        
        only_exceptions:
          - "Few ports with MAXIMUM strictness (top tier Italian ports)"
          - "Recent PSC degradation (check dates)"
    
    conflict_detection:
      if_contradiction_detected:
        condition: "Last Ports shows frequent EU calls BUT Equasis shows Black"
        action: "ğŸš¨ FLAG for manual review - data conflict"
        
        possible_explanations:
          - "Recent PSC status degradation (within last 6 months)"
          - "Equasis data lag/outdated information"
          - "Vessel changed ownership/management recently"
          - "Different vessel with similar name"
        
        ai_response:
          - "Show both data sources to user"
          - "Explain the contradiction"
          - "Request manual verification"
          - "Use conservative scoring (assume MEDIUM until verified)"
    
    confidence_adjustment:
      when_data_aligns:
        condition: "Equasis PSC status + Last Ports pattern AGREE"
        action: "Boost confidence: MEDIUM â†’ HIGH"
        example: "Equasis Grey + 30% EU calls â†’ HIGH confidence MEDIUM status"
      
      when_data_conflicts:
        condition: "Equasis and Last Ports CONTRADICT"
        action: "Flag uncertainty, use conservative approach"
        example: "Equasis Black + 40% EU calls â†’ Manual review needed"
      
      when_equasis_limited:
        condition: "Equasis data incomplete/missing"
        action: "Use Last Ports as SECONDARY indicator"
        heuristic: "Frequent EU calls â†’ assume at least MEDIUM status"
    
    application_guidelines:
      use_as_validation_not_override:
        correct_usage:
          - "âœ“ Boost confidence when Equasis + Last Ports align"
          - "âœ“ Flag conflicts when they contradict"  
          - "âœ“ Use as secondary indicator when Equasis incomplete"
        
        incorrect_usage:
          - "âŒ Do NOT ignore Equasis Black status based only on Last Ports"
          - "âŒ Do NOT assume GOOD status based ONLY on port history"
          - "âŒ Do NOT override hard blocks (sanctions, banning)"
        
        priority_order:
          1: "Hard blocks (EU sanctions, MOU bans) - ABSOLUTE"
          2: "Equasis PSC data - PRIMARY source"
          3: "Last Ports pattern - VALIDATION/CONFIDENCE tool"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# PORT PSC SEVERITY CLASSIFICATION
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

port_psc_severity:
  
  VERY_STRICT:
    description: "Highest PSC risk - vessels with issues avoid these"
    countries:
      tier_1_maximum: ["Italy", "France", "Greece"]
      tier_2_high: ["Germany", "Netherlands", "Belgium", "UK"]
      tier_3_medium_high: ["Spain", "Portugal", "Scandinavia", "Canada"]
      tokyo_mou: ["Japan", "Singapore", "South Korea", "Australia"]
      uscg: ["USA"]
  
  MODERATE:
    description: "Moderate PSC enforcement"
    countries:
      mediterranean_mou: ["Turkey", "Egypt", "Morocco", "Tunisia", "Algeria"]
      eu_moderate: ["Cyprus", "Malta", "Romania", "Bulgaria"]
      black_sea_mou: ["Georgia", "Ukraine"]
  
  LAX:
    description: "Minimal PSC enforcement - preferred by vessels with issues"
    countries:
      non_mou: ["Libya", "Syria"]
      weak_enforcement: ["Lebanon"]

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SCORING MATRIX
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

scoring_matrix:
  
  GOOD_vessel:
    VERY_STRICT_port: 
      score: [18, 20]
      reasoning: "Clean record, no restrictions"
    MODERATE_port:
      score: [18, 20]
      reasoning: "No issues"
    LAX_port:
      score: [18, 20]
      reasoning: "Can go anywhere"
  
  MEDIUM_vessel:
    VERY_STRICT_port:
      score: [8, 12]
      reasoning: "May face inspection, prefers other ports"
    MODERATE_port:
      score: [12, 15]
      reasoning: "Acceptable, moderate risk"
    LAX_port:
      score: [15, 18]
      reasoning: "Vessel prefers lax ports to avoid scrutiny"
  
  POOR_vessel:
    VERY_STRICT_port:
      score: [0, 5]
      reasoning: "CRITICAL - vessel will AVOID, high detention risk"
      owner_behavior: "Will NOT accept"
    MODERATE_port:
      score: [8, 12]
      reasoning: "Moderate risk, may attempt if necessary"
    LAX_port:
      score: [15, 18]
      reasoning: "Vessel STRONGLY PREFERS lax PSC - minimal risk"
      owner_behavior: "Actively seeks"
  
  BANNED_vessel:
    banned_region:
      score: 0
      reasoning: "ABSOLUTE BLOCK - cannot enter MOU region"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# HARD BLOCKS (Absolute Restrictions)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

hard_blocks:
  
  eu_sanctions:
    description: "EU sanctioned vessels (Russian shadow fleet)"
    source: "Danish Maritime Authority EU Vessel Designations"
    url: "https://www.dma.dk/.../eu-vessel-designations"
    format: "Downloadable .xlsx/.csv with IMO numbers"
    list_size: "~600 vessels (Jan 2026)"
    
    implementation:
      - "Download IMO list from DMA"
      - "Store locally in database"
      - "IF vessel.IMO IN sanctions_list â†’ P2A = 0 for ALL EU ports"
    
    blocked_regions: ["ALL EU countries", "ALL Paris MOU EU members"]
    allowed_regions: ["Turkey", "Egypt", "Libya", "Other non-EU"]
    
    note: "This is ABSOLUTE BAN, not low score. Vessel cannot legally enter."
  
  mou_banning:
    paris_mou:
      rule: "3 detentions in 24-36 months â†’ BAN"
      verification: "https://parismou.org/current-bannings"
    
    uscg:
      rule: "3 detentions in 12 months â†’ BAN"
      note: "Strictest timeline globally"
    
    implementation: "IF vessel.banned â†’ P2A = 0 for that MOU region"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SOFT FACTORS (Score Modifiers)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

soft_factors:
  
  classification_society:
    iacs_members: 
      list: ["DNV", "ABS", "Lloyd's Register", "ClassNK", "Bureau Veritas", "RINA", "CCS", "IRS", "PRS", "RMRS", "CRS"]
      impact: "+1 to +2 points"
    
    non_iacs:
      impact: "0 to -1 points"
    
    CRITICAL_RULE: "âš ï¸ NEVER block vessel based on class alone"
  
  pni_club:
    international_group:
      impact: "+1 point"
      examples: ["UK P&I", "Gard", "Skuld", "Standard Club"]
    
    CRITICAL_RULE: "âš ï¸ NEVER block vessel based on P&I alone (often missing in Equasis)"
  
  vessel_age:
    age_15_20: "-0 to -1 points"
    age_20_25: "-1 to -2 points"
    age_25_plus: "-2 to -3 points"
    
    CRITICAL_RULE: "âš ï¸ For dry cargo: NO hard age limits (age affects score, NOT access)"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# CALCULATION STEPS
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

calculation:
  
  step_1_hard_blocks:
    priority: "FIRST - before any scoring"
    - "IF vessel.IMO IN eu_sanctions â†’ RETURN P2A = 0"
    - "IF vessel.banned IN MOU â†’ RETURN P2A = 0 for that region"
  
  step_2_vessel_status:
    - "Extract Paris MOU status + detention rate from Equasis"
    - "Categorize as: GOOD / MEDIUM / POOR / BANNED"
  
  step_3_cross_validate_with_p4:
    - "Check P4 Last Ports for strict PSC country calls"
    - "IF >20% calls in strict PSC ports â†’ confirms GOOD/MEDIUM"
    - "IF Equasis Black + frequent EU calls â†’ FLAG conflict"
    - "Adjust confidence level based on alignment"
  
  step_4_port_severity:
    - "Map discharge country to: VERY_STRICT / MODERATE / LAX"
  
  step_5_base_score:
    - "Lookup scoring_matrix[vessel_status][port_severity]"
  
  step_6_soft_modifiers:
    - "Apply class (+/-1-2), P&I (+0-1), age (0 to -3)"
    - "Max adjustment: Â±3 points"
  
  step_7_final:
    - "P2A = CLAMP(base_score + modifiers, 0, 20)"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# AI IMPLEMENTATION GUIDELINES  
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ai_implementation:
  
  data_extraction:
    from_equasis:
      - "Parse Paris MOU status: White/Grey/Black"
      - "Extract detention rate percentage"
      - "Extract IMO number"
      - "Parse class society name (optional)"
      - "Parse P&I club name (optional)"
    
    from_p4_last_ports:
      - "Extract % of calls in strict PSC countries"
      - "Identify recent port patterns (12-24 months)"
      - "Note frequency of EU/strict PSC port calls"
  
  cross_validation_with_p4_last_ports:
    description: "Use historical port patterns to validate PSC assessment"
    
    step_1_analyze_port_history:
      calculate:
        - "% calls to VERY_STRICT countries (Italy, France, Germany, etc.)"
        - "% calls to MODERATE countries (Turkey, Egypt, etc.)"
        - "% calls to LAX countries (Libya, Syria, etc.)"
      
      thresholds:
        high_strict_exposure: ">20% calls in VERY_STRICT countries"
        moderate_strict_exposure: "10-20% calls in VERY_STRICT countries"
        low_strict_exposure: "<10% calls in VERY_STRICT countries"
    
    step_2_cross_validate:
      if_high_strict_exposure:
        expectation: "Vessel should have GOOD or MEDIUM PSC status"
        reasoning: |
          Cannot sustain >20% calls to strict PSC ports with Black status.
          Would face frequent detentions and entry denials.
        
        validation_checks:
          - "IF Equasis = White/Grey AND Last Ports >20% EU â†’ âœ“ ALIGNED"
          - "IF Equasis = Black AND Last Ports >20% EU â†’ ğŸš¨ CONFLICT"
      
      if_low_strict_exposure:
        note: "Neutral - vessel may have any PSC status"
        reasoning: "Lack of strict port calls doesn't indicate poor PSC"
    
    step_3_confidence_adjustment:
      aligned_data:
        condition: "Equasis PSC + Last Ports pattern agree"
        examples:
          - "Equasis Grey 5% + 30% EU calls â†’ MEDIUM status confirmed"
          - "Equasis White + 45% EU calls â†’ GOOD status confirmed"
        action: "Set confidence = HIGH"
      
      conflicting_data:
        condition: "Equasis and Last Ports contradict"
        examples:
          - "Equasis Black 11% + 40% EU calls â†’ DATA CONFLICT"
          - "Equasis White + 0% strict port calls â†’ unusual but possible"
        action: "Flag for manual review, use conservative scoring"
      
      missing_equasis:
        condition: "Equasis PSC data incomplete/unavailable"
        action: "Use Last Ports as SECONDARY indicator"
        heuristic:
          - "IF >30% strict PSC calls â†’ assume GOOD status"
          - "IF 15-30% strict PSC calls â†’ assume MEDIUM status"
          - "IF <15% strict PSC calls â†’ assume MEDIUM status (conservative)"
    
    step_4_apply_insights:
      vessel_accessibility_conclusion:
        if_validated_good_medium:
          can_access:
            - "Most European ports (including strict ones)"
            - "Turkish ports (moderate PSC)"
            - "Ukrainian ports (moderate PSC)"
            - "Arab ports (moderate/lax PSC)"
          
          exceptions:
            - "Few ports with MAXIMUM strictness (e.g., certain Italian ports)"
            - "Recent PSC degradation (check dates)"
        
        if_poor_status:
          will_avoid:
            - "Strict European ports (Italy, France, Germany)"
          
          will_prefer:
            - "Lax PSC ports (Libya, Syria, Lebanon)"
            - "Moderate ports if necessary (Turkey, Egypt)"
  
  transparency_requirements:
    always_show:
      - "Vessel PSC status: 'Paris MOU: {status}, Detention rate: {rate}%'"
      - "Port severity: '{country} - {severity} PSC region ({mou})'"
      - "Cross-validation: '{last_ports_pattern}' â†’ '{validation_result}'"
      - "Reasoning: '{vessel_status} vessel + {port_severity} port â†’ Base: {score}'"
      - "Final: 'P2A: {score}/20 - {interpretation}'"
      - "Confidence: '{level}' based on data alignment"
    
    when_using_p4_validation:
      show:
        - "Last Ports: {pct}% calls in strict PSC countries"
        - "Validation: Historical pattern {confirms/contradicts} Equasis status"
        - "Confidence: {HIGH/MEDIUM/LOW} - {reason}"
      
      examples:
        aligned: |
          "Last Ports: 35% calls in EU (Italy, Germany, Netherlands)
          Validation: âœ“ Confirms Equasis Grey status - vessel can reliably access strict PSC ports
          Confidence: HIGH - data sources aligned"
        
        conflicting: |
          "Last Ports: 42% calls in EU strict PSC ports
          Equasis: Paris MOU Black, 11.1% detention
          âš ï¸ DATA CONFLICT - Historical pattern contradicts current PSC status
          Possible causes: Recent PSC degradation, Equasis lag, or data error
          Recommendation: Manual review required
          Using: Conservative MEDIUM status assumption"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# EXAMPLES WITH CROSS-VALIDATION
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

examples:
  
  example_1_aligned_data:
    scenario: "Equasis and Last Ports both confirm GOOD status"
    
    vessel:
      equasis: "Paris Grey, 2.8% detention, DNV class"
      last_ports: "39% EU calls (Italy 12%, Germany 17%, Netherlands 10%)"
    
    validation:
      result: "âœ“ CONFIRMS GOOD status"
      confidence: "HIGH - data aligned"
      accessibility: "Can access most EU, Turkish, Ukrainian, Arab ports"
    
    cargo:
      port: "Constanta, Romania (MODERATE)"
    
    score: "20/20"
    
    reasoning: |
      "Vessel has excellent PSC record: Paris Grey with only 2.8% detention rate.
      Historical pattern shows 39% of calls in strict EU ports.
      This validates vessel can reliably access European ports without issues.
      P2A = 20/20 - HIGH confidence, vessel will accept."
  
  example_2_conflict_detected:
    scenario: "Equasis Black but Last Ports shows frequent EU calls"
    
    vessel:
      equasis: "Paris Black, 9.5% detention"
      last_ports: "40% EU calls (France, Germany, Italy until Oct 2025)"
    
    validation:
      result: "ğŸš¨ CONFLICT DETECTED"
      possible_causes: "Recent PSC degradation, Equasis lag, management change"
      action: "FLAG for manual review"
      conservative_approach: "Assume MEDIUM status until verified"
    
    cargo:
      port: "Marseille, France (VERY_STRICT)"
    
    score: "10/20 (conservative)"
    
    reasoning: |
      "âš ï¸ DATA CONFLICT: Equasis shows Black but vessel called EU ports 40% of time.
      This is contradictory - Black vessels typically cannot sustain EU pattern.
      Using conservative MEDIUM assumption â†’ Score: 10/20
      Confidence: LOW - Manual review required"
  
  example_3_poor_vessel_lax_port:
    scenario: "Poor PSC vessel heading to lax port - validated"
    
    vessel:
      equasis: "Paris Black, 11.1% detention"
      last_ports: "0% strict PSC, 100% moderate/lax (Libya 36%, Egypt 29%, Syria 21%)"
    
    validation:
      result: "âœ“ CONFIRMS POOR status"
      reasoning: "Vessel actively avoids strict PSC - behavioral pattern matches"
      confidence: "HIGH - perfectly aligned"
    
    cargo:
      port: "Tripoli, Libya (LAX)"
    
    score: "17/20"
    
    reasoning: |
      "Vessel has poor PSC record confirmed by behavior pattern.
      Actively avoids EU (0% strict calls), seeks lax enforcement (Libya 36%).
      Tripoli, Libya (LAX PSC) â†’ Perfect match.
      P2A = 17/20 - HIGH confidence, owner PREFERS this"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# CRITICAL RULES
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

critical_rules:
  
  1_no_class_blocks:
    rule: "NEVER block vessel based on class or P&I alone"
    reason: "Equasis data can be outdated, vessels always have some class"
  
  2_sanctions_absolute:
    rule: "EU sanctions = P2A = 0, not negotiable"
    reason: "Legal prohibition under EU Council Regulation 833/2014"
  
  3_poor_plus_lax_high:
    rule: "Poor vessel + Lax port = HIGH score (15-18)"
    reason: "Vessels with PSC problems SEEK lax enforcement - this is CORRECT"
  
  4_no_age_limits:
    rule: "For dry cargo, age affects score but NEVER blocks"
    reason: "Unlike tankers, no regulatory age limits for bulkers/general cargo"
  
  5_detention_thresholds:
    good: "<3% detention rate"
    medium: "3-8% detention rate"
    poor: ">8% detention rate"
    context: "Average Paris MOU detention rate = 3-4%"
  
  6_p4_validation_not_override:
    rule: "Last Ports pattern validates but does NOT override Equasis"
    priority_order:
      1: "Hard blocks (sanctions, bans) - ABSOLUTE"
      2: "Equasis PSC data - PRIMARY source"
      3: "Last Ports pattern - VALIDATION tool"
    
    correct_use:
      - "âœ“ Boost confidence when data aligns"
      - "âœ“ Flag conflicts for review"
      - "âœ“ Use as secondary when Equasis missing"
    
    incorrect_use:
      - "âŒ Do NOT ignore Black status based only on port history"
      - "âŒ Do NOT override hard blocks"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# REFERENCES
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

references:
  paris_mou: "https://www.parismou.org"
  tokyo_mou: "https://www.tokyo-mou.org"
  eu_sanctions: "https://www.dma.dk/.../eu-vessel-designations"
  equasis: "https://www.equasis.org"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# VERSION HISTORY
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

version_history:
  v1.1_2026_01_16:
    changes:
      - "Added P4 Last Ports cross-validation"
      - "Historical patterns validate PSC status"
      - "Conflict detection when data contradicts"
      - "Confidence adjustment based on alignment"
      - "Accessibility conclusions from port history"
    
    key_feature:
      logic: |
        Frequent calls to strict PSC ports (>20% in Italy, France, Germany)
        confirms GOOD/MEDIUM status. Cannot sustain with Black status.
        Use for validation and confidence boost, NOT override.
  
  v1.0_2026_01_16:
    - "Initial production version"
    - "Hard blocks: EU sanctions + MOU banning"
    - "Soft factors: Class, P&I, Age (NO hard blocks)"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
