================================================================================
P2A — PSC PORT ACCESSIBILITY SCORING
Version: 3.0
Last updated: 2026-02-07
================================================================================

PURPOSE:
  Evaluate whether the vessel can safely call at the cargo's loading and 
  discharge ports without excessive PSC (Port State Control) risk. Considers
  vessel's class, P&I, age, flag, and inspection history against port 
  strictness tiers.

SCORE RANGE: [0, 20]
ALWAYS ACTIVE: This criterion always has max_score = 20

================================================================================
PORT STRICTNESS TIERS
================================================================================

  TIER 1 — Very Strict (high detention risk)
  ─────────────────────────────────────────
    Countries: Italy, France, Greece, Spain, Portugal, Belgium, Netherlands,
               Germany, UK, Ireland, Norway, Sweden, Denmark, Finland,
               Australia, New Zealand, Canada, Japan, South Korea
    
  TIER 2 — Moderate Strict
  ─────────────────────────────────────────
    Countries: Turkey, Croatia, Slovenia, Montenegro, Albania, 
               Romania, Bulgaria, Egypt (Suez/Alex)
               
  TIER 3 — Moderate Tolerant
  ─────────────────────────────────────────
    Countries: Ukraine, Russia (Black Sea ports), Georgia, 
               Tunisia, Algeria, Morocco, Libya, Lebanon, Syria
               
  TIER 4 — Lax (low detention risk)
  ─────────────────────────────────────────
    Countries: Most West Africa, India, Bangladesh, Pakistan,
               most Southeast Asia, Central America, South America

================================================================================
VESSEL STATUS CATEGORIES
================================================================================

  HIGH STATUS — Score bonus for strict ports
    - IACS class (BV, LR, DNV, ABS, ClassNK, RINA, CCS, KR, RS, PRS, CRS, IRS)
    - Top-tier P&I (IG clubs)
    - Flag: EU/established maritime nation
    - Age: < 15 years
    
  MEDIUM STATUS — Standard scoring
    - IACS class OR recognized non-IACS
    - P&I coverage exists
    - Flag: acceptable but not premium
    - Age: 15-25 years
    
  LOW STATUS — Penalty for strict ports
    - Non-IACS class or unknown
    - No P&I or unknown P&I
    - Flag of convenience / blacklisted
    - Age: > 25 years

================================================================================
BASE SCORING MATRIX
================================================================================

  Score = f(vessel_status, port_tier)

  Port Tier 1 (Very Strict):
    HIGH status:   16-20/20
    MEDIUM status: 10-14/20
    LOW status:    2-6/20 (potential BLOCK if critical deficiency)

  Port Tier 2 (Moderate Strict):
    HIGH status:   18-20/20
    MEDIUM status: 14-17/20
    LOW status:    6-10/20

  Port Tier 3 (Moderate Tolerant):
    HIGH status:   20/20
    MEDIUM status: 16-19/20
    LOW status:    10-14/20

  Port Tier 4 (Lax):
    HIGH status:   20/20
    MEDIUM status: 18-20/20
    LOW status:    14-18/20

================================================================================
PORT HISTORY BONUS
================================================================================

  If the vessel has RECENT successful calls at ports in the SAME TIER or 
  HIGHER (stricter) tier as the cargo ports, apply a bonus.
  
  The bonus reflects proven ability to pass PSC at that level of strictness.
  
  RULES:
    - Bonus applies to ports of the SAME tier AND lower (less strict) tiers
    - Bonuses do NOT stack — use the highest applicable bonus only
    - "Recent" = within the last 12 months of port call history
    - We do NOT have detention data — do not require "no detention" condition

  BONUS VALUES:
  
    Tier 1 (Very Strict) history found:
      → +3 bonus for ALL port tiers (Tier 1, 2, 3, 4)
      Rationale: If vessel passed Italy/France PSC, she's good everywhere
      
    Tier 2 (Moderate Strict / Turkey) history found:
      → +2 bonus for Tier 2, 3, and 4 ports
      → NO bonus for Tier 1 ports
      Rationale: Turkey PSC clearance doesn't guarantee Italy clearance
      
    Tier 3 (Moderate Tolerant) history found:
      → +1 bonus for Tier 3 and 4 ports only
      → NO bonus for Tier 1 or 2 ports

    Tier 4 (Lax) history found:
      → No bonus (doesn't prove anything)

  EXAMPLES:
  
    Example 1: Vessel called at Ravenna (Italy, Tier 1)
      → Cargo ports: Thessaloniki (Greece, Tier 1) → +3 bonus
      → Cargo ports: Mersin (Turkey, Tier 2) → +3 bonus  
      → Cargo ports: Chornomorsk (Ukraine, Tier 3) → +3 bonus
      
    Example 2: Vessel called at Istanbul (Turkey, Tier 2)
      → Cargo ports: Genoa (Italy, Tier 1) → NO bonus
      → Cargo ports: Constanta (Romania, Tier 2) → +2 bonus
      → Cargo ports: Odessa (Ukraine, Tier 3) → +2 bonus
      
    Example 3: Vessel called at both Naples (Tier 1) AND Samsun (Tier 2)
      → Use highest applicable: Naples gives +3 for everything
      → Do NOT add +3 and +2 together

  BONUS CAP: Total P2A score cannot exceed 20

================================================================================
SCORING FOR MULTIPLE PORTS
================================================================================

  When cargo has both loading and discharge ports:
    - Score each port separately
    - Final P2A = weighted average (load port 60%, discharge port 40%)
    - If either port results in BLOCK → entire P2A is BLOCK

================================================================================
BLOCK CONDITIONS
================================================================================

  - LOW status vessel + Tier 1 port + no port history bonus → BLOCK
  - Vessel on Paris MOU blacklist + any EU port → BLOCK
  - No class certificate available + Tier 1 or 2 port → BLOCK

================================================================================
OFFER HINTS
================================================================================

  High score (16+): null (no PSC concerns to mention)
  
  Medium score (10-15): "PSC risk is manageable but be aware — vessel's 
    [class/age/flag] may draw attention at [port]. Recent successful calls 
    at similar ports help."
    
  Low score (<10): "Significant PSC risk at [port]. Consider whether owner 
    is willing to accept inspection risk. Mention alternative discharge 
    options if available."
    
  BLOCK: "Vessel cannot safely call at [port] — PSC risk too high. 
    Do not offer for this port combination."

================================================================================
AI INSTRUCTIONS
================================================================================

  ai_must:
    - Check vessel class against IACS member list
    - Check P&I club if available
    - Determine vessel status category (HIGH/MEDIUM/LOW)
    - Look up port tiers for all cargo ports
    - Check vessel's port call history for bonus eligibility
    - Apply highest applicable bonus (no stacking)
    - Score using the matrix
    - Generate appropriate offer_hint
    
  ai_must_not:
    - Never require "no detention" data (we don't have it)
    - Never stack multiple port history bonuses
    - Never apply Tier 2 bonus to Tier 1 ports
    - Never ignore port history when it's available
    - Never block a vessel solely based on age without considering other factors

================================================================================
