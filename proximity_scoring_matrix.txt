# ═══════════════════════════════════════════════════════════════════
# PROXIMITY SCORING MATRIX
# VK Charts AI Scoring System - Criterion P1
# ═══════════════════════════════════════════════════════════════════
#
# SHORT SUMMARY
#
# This file defines P1 (Proximity) scoring - how AI evaluates geographic
# distance compatibility between vessel's current position and cargo's
# loading port. P1 contributes 0-20 points to the total score (100 max).
#
# WHAT THIS FILE CONTAINS:
#
# 1. INTERNAL SCORING LEVELS (0-50 internal points)
#    - Level 1: Same port = 50 internal points
#    - Level 7: Marmara Sea = 20 internal points
#    - Level 12: Beyond viable range = -10 internal points
#    - These are SCALED to final P1 range [0, 20]
#
# 2. VESSEL SIZE ADJUSTMENTS
#    - Coasters (4001-17000 DWT): Limited range, higher penalties
#    - Small Handy (17001-24000 DWT): Better tolerance
#    - Handy (24001-40000 DWT): Good long-distance capability
#    - Supramax/Panamax (40000+ DWT): Can ballast globally
#
# 3. DISTANCE PENALTIES
#    - Fine-tuning based on actual nautical miles within same level
#    - Penalty per 100nm varies by vessel size
#
# 4. GEOPOLITICAL RESTRICTIONS
#    - Ukraine-Russia war sanctions (IMPOSSIBLE scoring)
#    - Port accessibility by vessel size
#
# 5. AI USAGE INSTRUCTIONS
#    - Step-by-step scoring process
#    - Location determination logic
#    - Score calculation and scaling
#
# CRITICAL NOTE:
# Internal scores (0-50) in this file are SCALED to P1 final range [0, 20]
# according to MASTER_SCORING_SYSTEM.txt formula.
#
# ═══════════════════════════════════════════════════════════════════

# ═══════════════════════════════════════════════════════════════════
# HOW TO USE THIS DOCUMENT
# ═══════════════════════════════════════════════════════════════════

how_to_use:
  
  for_developers:
    role: "Laravel Backend Integration"
    responsibilities:
      - "Pass this file to AI as knowledge source (not for AI to rewrite)"
      - "Provide vessel's current location (use vessel_location_determination.txt)"
      - "Provide cargo's loading port information"
      - "Receive P1 score [0-20] from AI with explanation"
      - "DO NOT implement scoring formula in code - AI computes it"
    
    data_flow:
      step_1: "Determine vessel effective location (port, region, sea)"
      step_2: "Get cargo loading port (port, region, sea)"
      step_3: "Pass both locations + this file content to AI"
      step_4: "AI returns: P1 score [0-20], explanation, reasoning"
    
    important_notes:
      - "This file = single source of truth for P1 proximity logic"
      - "All scoring happens in AI, not in Laravel code"
      - "Changes to this file automatically affect all future scores"
  
  for_ai_langchain:
    role: "Proximity Scoring Implementation"
    process:
      step_1: "Read vessel location from input"
      step_2: "Read cargo loading port from input"
      step_3: "Determine vessel size category (DWT)"
      step_4: "Find matching proximity level in this file"
      step_5: "Get internal base score (0-50 range)"
      step_6: "Apply distance penalty if applicable"
      step_7: "Apply geopolitical restrictions if applicable"
      step_8: "Scale final internal score to P1 range [0-20]"
      step_9: "Generate explanation and reasoning"
    
    json_output_format:
      example: |
        {
          "criterion_1_proximity": {
            "score": 7.6,
            "score_range": "[0-20]",
            "internal_calculation": "level_7_marmara_sea: 20 internal points - 0.96 penalty = 19.04 → scaled to 7.6/20",
            "explanation": "Vessel in Marmara Sea, cargo loading Black Sea. Acceptable ballast through Bosphorus.",
            "reasoning": "For coaster-size vessel, Marmara to Black Sea is Level 7 proximity..."
          }
        }
    
    scaling_formula:
      internal_to_final: "P1_final = (internal_score / 50) * 20"
      example_1: "Internal 50 → P1 = 20 (maximum)"
      example_2: "Internal 25 → P1 = 10 (mid-range)"
      example_3: "Internal 0 → P1 = 0 (minimum)"
      example_4: "Internal -10 → P1 = 0 (blocked, cannot be negative)"
  
  for_knowledge_base_updates:
    role: "Maintaining Proximity Logic"
    when_to_update:
      - "New trade patterns emerge (e.g., new strategic routes)"
      - "Geopolitical changes (sanctions, war zones)"
      - "Market behavior shifts (vessel sizes, ballast economics)"
      - "Port restrictions change (draft, vessel size limits)"
    
    update_process:
      step_1: "Identify what needs changing (specific level, penalty, restriction)"
      step_2: "Update only affected sections in this file"
      step_3: "Document change in version history at bottom"
      step_4: "Test with sample vessel-cargo pairs"
      step_5: "AI automatically uses new logic (no code deployment needed)"
    
    important_principles:
      - "Keep internal scoring levels (0-50) for granularity"
      - "Always scale to P1 final range [0-20]"
      - "Document reasoning for any level adjustments"
      - "Preserve vessel size differentiation"
  
  quick_reference:
    p1_range: "[0, 20] - final score range for P1"
    internal_range: "[0, 50] - used for detailed level scoring"
    vessel_sizes:
      - "Coasters: 4001-17000 DWT"
      - "Small Handy: 17001-24000 DWT"
      - "Handy: 24001-40000 DWT"
      - "Supramax/Panamax: 40000-80000 DWT"
    key_levels:
      - "Level 1 (same port): 50 internal → ~20 P1"
      - "Level 6 (same sea): 30 internal → ~12 P1"
      - "Level 7 (Marmara): 20 internal → ~8 P1"
      - "Level 11 (West Med): 0-8 internal → ~0-3 P1"
    blocking_conditions:
      - "Ukraine ↔ Russia: IMPOSSIBLE"
      - "Vessel DWT > Port capacity: IMPOSSIBLE"

# ═══════════════════════════════════════════════════════════════════
# METADATA
# ═══════════════════════════════════════════════════════════════════

version: "1.1"
last_updated: "2024-12-01"
source: "Vitaly (VK Charts expert)"

changelog:
  - version: "1.1"
    date: "2024-12-01"
    changes:
      - "Added structured SHORT SUMMARY block"
      - "Added comprehensive HOW TO USE DOCUMENT block"
      - "FIXED: Clarified P1 final range [0, 20] vs internal scoring [0-50]"
      - "FIXED: Corrected JSON example from <0-25> to <0-20>"
      - "Added scaling formula: (internal_score / 50) * 20 = P1_final"
      - "Enhanced documentation for developers and AI implementation"
  - version: "1.0"
    date: "2024-11-27"
    changes:
      - "Initial version with proximity levels and vessel size adjustments"

# ═══════════════════════════════════════════════════════════════════
# SCORING PRINCIPLE
# ═══════════════════════════════════════════════════════════════════

scoring_principle: |
  Proximity = Lower ballast cost = Higher score
  
  Чем ближе судно к порту погрузки, тем выше score
  
  INTERNAL SCORING: 0-50 points (used for detailed level differentiation)
  FINAL P1 SCORE: 0-20 points (scaled from internal score)
  
  Scaling formula: P1_final = (internal_score / 50) * 20

# ═══════════════════════════════════════════════════════════════════
# GEOGRAPHIC HIERARCHY
# ═══════════════════════════════════════════════════════════════════

geographic_structure:
  description: "Based on Airtable cargo geographic data"
  
  hierarchy:
    - "Port (lowest level)"
    - "Country"
    - "Region (optional sub-grouping)"
    - "Sea"
    - "Global Region (highest level)"
  
  example:
    port: "Odessa"
    country: "Ukraine"
    region: "POC"
    sea: "Black Sea"
    global_region: "Eastern Europe"

# ═══════════════════════════════════════════════════════════════════
# BLACK SEA SUB-REGIONS
# ═══════════════════════════════════════════════════════════════════

black_sea_subregions:
  
  poc:
    name: "POC (Pivdenny-Odessa-Chornomorsk)"
    country: "Ukraine"
    ports:
      - "Odessa"
      - "Pivdenny (Yuzhny)"
      - "Chornomorsk (Ilyichevsk)"
    characteristics:
      - "Major grain export hub"
      - "Close proximity to each other"
      - "Shared anchorage areas"
  
  sulina_anchorage:
    name: "Sulina Anchorage"
    country: "Romania/International waters"
    characteristics:
      - "Strategic position"
      - "Can access BOTH Danube AND POC"
      - "Excellent positioning for either direction"
    
  danube_ports:
    name: "Danube River Ports"
    countries: ["Romania", "Moldova", "Ukraine"]
    ports:
      romania:
        - "Galati"
        - "Braila"
      moldova:
        - "Giurgiulesti"
      ukraine:
        - "Kiliya"
        - "Orlovka"
        - "Izmail"
        - "Reni"
    characteristics:
      - "River ports"
      - "Draft restrictions"
      - "Smaller vessel sizes"
  
  cvb:
    name: "CVB (Constanta-Varna-Burgas)"
    countries: ["Romania", "Bulgaria"]
    ports:
      romania:
        - "Constanta"
      bulgaria:
        - "Varna"
        - "Burgas"
    characteristics:
      - "Major Black Sea ports"
      - "Good facilities"
      - "Western Black Sea"
  
  turkish_black_sea:
    name: "Turkish Black Sea Ports"
    country: "Turkey"
    ports:
      - "Samsun"
      - "Trabzon"
      - "Zonguldak"
      - "Eregli"
      - "And other Turkish Black Sea ports"
  
  russian_black_sea:
    name: "Russian Black Sea Ports"
    country: "Russia"
    ports:
      - "Novorossiysk"
      - "Kavkaz (Caucasus)"
      - "Other Russian Black Sea ports"
    
    geopolitical_restriction:
      status: "BLOCKED due to Ukraine-Russia war"
      ukraine_to_russia: "IMPOSSIBLE - sanctions"
      russia_to_ukraine: "IMPOSSIBLE - sanctions"
      effective_date: "2022-present"
  
  georgian_black_sea:
    name: "Georgian Black Sea Ports"
    country: "Georgia"
    ports:
      - "Poti"
      - "Batumi"

# ═══════════════════════════════════════════════════════════════════
# PROXIMITY SCORING - COASTERS (4001-17000 DWT)
# ═══════════════════════════════════════════════════════════════════

proximity_scoring_coasters:
  vessel_size_range: [4001, 17000]
  cargo_loading_example: "Black Sea (Odessa)"
  
  levels:
    
    level_1_same_port:
      internal_score: 50
      p1_equivalent: "~20 points"
      description: "Vessel in same port as loading port"
      examples:
        - vessel_location: "Odessa"
          cargo_loading: "Odessa"
          result: "Perfect - zero ballast"
      
    level_2_same_port_cluster:
      internal_score: 45
      p1_equivalent: "~18 points"
      description: "Vessel in same port cluster/region"
      examples:
        - vessel_location: "Pivdenny"
          cargo_loading: "Odessa"
          result: "POC cluster - minimal ballast (few hours)"
        - vessel_location: "Chornomorsk"
          cargo_loading: "Odessa"
          result: "POC cluster - minimal ballast"
      
    level_3_sulina_anchorage:
      internal_score: 48
      p1_equivalent: "~19 points"
      description: "Special case - Sulina Anchorage"
      reasoning: "Can access both POC and Danube easily"
      examples:
        - vessel_location: "Sulina Anchorage"
          cargo_loading: "Odessa"
          result: "Very close, excellent positioning"
        - vessel_location: "Sulina Anchorage"
          cargo_loading: "Reni (Danube)"
          result: "Also very close"
    
    level_4_same_subregion:
      internal_score: 40
      p1_equivalent: "~16 points"
      description: "Vessel in different port within same Black Sea sub-region"
      examples:
        - vessel_location: "Constanta"
          cargo_loading: "POC"
          result: "Both CVB region - short ballast"
      
    level_5_nearby_subregion:
      internal_score: 35
      p1_equivalent: "~14 points"
      description: "Vessel in nearby Black Sea sub-region"
      examples:
        - vessel_location: "CVB"
          cargo_loading: "POC"
          result: "Short cross-Black Sea ballast"
     
    level_6_same_black_sea:
      internal_score: 30
      p1_equivalent: "~12 points"
      description: "Vessel anywhere in Black Sea"
      examples:
        - vessel_location: "Turkish Black Sea"
          cargo_loading: "Odessa"
          result: "Same sea but longer ballast"
        - vessel_location: "Batumi (Georgia)"
          cargo_loading: "Odessa"
          result: "Cross Black Sea ballast"
      
      geopolitical_exceptions:
        ukraine_russia_block:
          condition: "Ukraine port ↔ Russian vessel OR Russia port ↔ Ukrainian vessel"
          score: "IMPOSSIBLE"
          reason: "War, sanctions, blocked"
          examples:
            - vessel: "Russian flag in Novorossiysk"
              cargo: "Loading in Odessa"
              result: "IMPOSSIBLE - cannot enter Ukraine"
            - vessel: "Any vessel in Ukraine"
              cargo: "Loading in Novorossiysk"  
              result: "IMPOSSIBLE - cannot enter Russia"
    
    level_7_marmara_sea:
      internal_score: 20
      p1_equivalent: "~8 points"
      description: "Vessel in Marmara Sea"
      examples:
        - vessel_location: "Istanbul"
          cargo_loading: "Odessa"
          result: "Bosphorus crossing + Black Sea ballast"
        - vessel_location: "Derince"
          cargo_loading: "Constanta"
          result: "Acceptable ballast"
      
    level_8_izmir_nemrut_east_greece:
      internal_score: 12
      p1_equivalent: "~5 points"
      description: "Vessel in line of Izmir-Nemrut Bay area and east coast Greece"
      examples:
        - vessel_location: "Izmir"
          cargo_loading: "Odessa"
          result: "Med → Dardanelles → Marmara → Bosphorus → Black Sea"
        - vessel_location: "Nemrut Bay"
          cargo_loading: "Constanta"
          result: "Short to Dardanelles, then Black Sea"
        - vessel_location: "Thessaloniki"
          cargo_loading: "Varna"
          result: "Eastern Greece → Black Sea acceptable"
      
    level_9_east_med:
      internal_score: 8
      p1_equivalent: "~3 points"
      description: "Vessel in East Mediterranean"
      examples:
        - vessel_location: "Limassol (Cyprus)"
          cargo_loading: "Odessa"
          result: "Longer Med → Black Sea ballast"
        - vessel_location: "Lebanon"
          cargo_loading: "Constanta"
          result: "East Med → Black Sea feasible but long"
      
    level_10_adriatic_ionian:
      internal_score: 4
      p1_equivalent: "~2 points"
      description: "Vessel in Adriatic or Ionian Sea"
      examples:
        - vessel_location: "Bar (Montenegro)"
          cargo_loading: "Odessa"
          result: "Adriatic → Med → Black Sea - long ballast"
        - vessel_location: "Durres (Albania)"
          cargo_loading: "Constanta"
          result: "Ionian → Med → Black Sea - marginal for coasters"
      notes: "Approaching limit for coasters"
    
    level_11_west_med:
      internal_score: 0
      p1_equivalent: "0 points"
      description: "Vessel in West Mediterranean - RARE for coasters"
      examples:
        - vessel_location: "Barcelona"
          cargo_loading: "Odessa"
          result: "Very long ballast - unlikely for coaster"
      notes: "Coasters typically won't ballast from this distance"
    
    level_12_beyond:
      internal_score: -10
      p1_equivalent: "0 points (blocked)"
      description: "Further than West Med - NOT VIABLE for coasters"
      examples:
        - vessel_location: "Atlantic"
        - vessel_location: "North Europe"
        - vessel_location: "Asia"
      notes: "Coasters working in these areas, not positioning to Black Sea"

# ═══════════════════════════════════════════════════════════════════
# PROXIMITY SCORING - SMALL HANDY (17001-24000 DWT)
# ═══════════════════════════════════════════════════════════════════

proximity_scoring_small_handy:
  vessel_size_range: [17001, 24000]
  cargo_loading_example: "Black Sea (Odessa)"
  
  levels:
    # Same top levels as coasters
    level_1_same_port:
      internal_score: 50
      p1_equivalent: "~20 points"
      
    level_2_same_port_cluster:
      internal_score: 45
      p1_equivalent: "~18 points"
      
    level_3_sulina_anchorage:
      internal_score: 48
      p1_equivalent: "~19 points"
      
    level_4_same_subregion:
      internal_score: 40
      p1_equivalent: "~16 points"
      
    level_5_nearby_subregion:
      internal_score: 35
      p1_equivalent: "~14 points"
      
    level_6_same_black_sea:
      internal_score: 30
      p1_equivalent: "~12 points"
      
    level_7_marmara_sea:
      internal_score: 22
      p1_equivalent: "~9 points"
      note: "Slightly higher than coasters"
      
    level_8_izmir_nemrut_east_greece:
      internal_score: 15
      p1_equivalent: "~6 points"
      note: "Better tolerance"
      
    level_9_east_med:
      internal_score: 10
      p1_equivalent: "~4 points"
      
    level_10_adriatic_ionian:
      internal_score: 6
      p1_equivalent: "~2 points"
      
    level_11_west_med:
      internal_score: 3
      p1_equivalent: "~1 point"
      description: "Feasible but not optimal"
      
    level_12_italy_spain:
      internal_score: 1
      p1_equivalent: "~0.4 points"
      description: "Marginal for small handy"
      
    level_13_beyond:
      internal_score: -5
      p1_equivalent: "0 points (blocked)"
      description: "Atlantic, North Europe - unlikely"

# ═══════════════════════════════════════════════════════════════════
# PROXIMITY SCORING - HANDY (24001-40000 DWT)
# ═══════════════════════════════════════════════════════════════════

proximity_scoring_handy:
  vessel_size_range: [24001, 40000]
  cargo_loading_example: "Black Sea (Odessa)"
  
  levels:
    # Same top levels (1-10)
    level_1_same_port:
      internal_score: 50
      p1_equivalent: "~20 points"
      
    level_2_same_port_cluster:
      internal_score: 45
      p1_equivalent: "~18 points"
      
    level_3_sulina_anchorage:
      internal_score: 48
      p1_equivalent: "~19 points"
      
    level_4_same_subregion:
      internal_score: 40
      p1_equivalent: "~16 points"
      
    level_5_nearby_subregion:
      internal_score: 35
      p1_equivalent: "~14 points"
      
    level_6_same_black_sea:
      internal_score: 30
      p1_equivalent: "~12 points"
      
    level_7_marmara_sea:
      internal_score: 22
      p1_equivalent: "~9 points"
      
    level_8_izmir_nemrut_east_greece:
      internal_score: 15
      p1_equivalent: "~6 points"
      
    level_9_east_med:
      internal_score: 10
      p1_equivalent: "~4 points"
      
    level_10_adriatic_ionian:
      internal_score: 6
      p1_equivalent: "~2 points"
    
    level_11_west_med:
      internal_score: 8
      p1_equivalent: "~3 points"
      description: "Acceptable for handy size"
      
    level_12_italy_france_spain:
      internal_score: 8
      p1_equivalent: "~3 points"
      
    level_13_gibraltar_area:
      internal_score: 8
      p1_equivalent: "~3 points"
      
    level_14_north_europe_baltic:
      internal_score: 2
      p1_equivalent: "~1 point"
      description: "Long but possible for handy"
      
    level_15_atlantic:
      internal_score: 0
      p1_equivalent: "0 points"
      description: "Very long ballast - marginal"
      
    level_16_beyond:
      internal_score: -10
      p1_equivalent: "0 points (blocked)"
      description: "Americas, Asia - not viable"

# ═══════════════════════════════════════════════════════════════════
# PROXIMITY SCORING - SUPRAMAX/PANAMAX (40000+ DWT)
# ═══════════════════════════════════════════════════════════════════

proximity_scoring_large_vessels:
  vessel_size_range: [40000, 80000]
  cargo_loading_example: "Black Sea (Odessa)"
  
  levels:
    # Same top levels (1-10)
    level_1_same_port:
      internal_score: 50
      p1_equivalent: "~20 points"
      
    level_2_same_port_cluster:
      internal_score: 45
      p1_equivalent: "~18 points"
      
    level_3_sulina_anchorage:
      internal_score: 48
      p1_equivalent: "~19 points"
      
    level_4_same_subregion:
      internal_score: 40
      p1_equivalent: "~16 points"
      
    level_5_nearby_subregion:
      internal_score: 35
      p1_equivalent: "~14 points"
      
    level_6_same_black_sea:
      internal_score: 30
      p1_equivalent: "~12 points"
      
    level_7_marmara_sea:
      internal_score: 22
      p1_equivalent: "~9 points"
      
    level_8_izmir_nemrut_east_greece:
      internal_score: 15
      p1_equivalent: "~6 points"
      
    level_9_east_med:
      internal_score: 10
      p1_equivalent: "~4 points"
      
    level_10_adriatic_ionian:
      internal_score: 6
      p1_equivalent: "~2 points"
    
    level_11_west_med:
      internal_score: 15
      p1_equivalent: "~6 points"
      description: "Good for large vessels"
      
    level_12_atlantic_islands:
      internal_score: 10
      p1_equivalent: "~4 points"
      
    level_13_north_europe:
      internal_score: 8
      p1_equivalent: "~3 points"
      description: "Long haul acceptable"
      
    level_14_uk_ireland:
      internal_score: 6
      p1_equivalent: "~2 points"
      
    level_15_west_africa:
      internal_score: 5
      p1_equivalent: "~2 points"
      description: "Can ballast if rates justify"
      
    level_16_americas_ecsa:
      internal_score: 3
      p1_equivalent: "~1 point"
      description: "Very long but possible"
      
    level_17_far_east_asia:
      internal_score: 0
      p1_equivalent: "0 points"
      description: "Extremely long - only if positioning for major cargo program"
      
    level_18_beyond:
      internal_score: -5
      p1_equivalent: "0 points (blocked)"

# ═══════════════════════════════════════════════════════════════════
# DISTANCE FACTOR (Nautical Miles)
# ═══════════════════════════════════════════════════════════════════

distance_adjustment:
  description: "Fine-tune score based on actual distance within same level"
  
  formula: "final_internal_score = base_level_score - (distance_penalty × MARITIME_distance_nm / 100)"
  
  note: "After distance adjustment, scale internal score to P1 range [0-20]"
  
  distance_penalty_by_vessel_size:
    small_coasters:
      penalty_per_100nm: 0.5
      max_penalty: 10
      
    coasters:
      penalty_per_100nm: 0.3
      max_penalty: 8
      
    small_handy:
      penalty_per_100nm: 0.2
      max_penalty: 6
      
    handy:
      penalty_per_100nm: 0.15
      max_penalty: 5
      
    supramax_panamax:
      penalty_per_100nm: 0.1
      max_penalty: 3
  
  examples:
    - vessel: "Coaster in Constanta"
      cargo: "Loading Odessa"
      distance: "~250 nm"
      base_internal_score: 35  # level_5_nearby_subregion
      distance_penalty: "0.3 × 250/100 = 0.75"
      final_internal_score: "35 - 0.75 = 34.25"
      p1_final: "(34.25 / 50) * 20 = 13.7 points"
      
    - vessel: "Coaster in Istanbul"
      cargo: "Loading Odessa"
      distance: "~320 nm"
      base_internal_score: 20  # level_7_marmara_sea
      distance_penalty: "0.3 × 320/100 = 0.96"
      final_internal_score: "20 - 0.96 = 19.04"
      p1_final: "(19.04 / 50) * 20 = 7.6 points"

# ═══════════════════════════════════════════════════════════════════
# PORT SIZE FACTOR
# ═══════════════════════════════════════════════════════════════════

port_size_impact:
  description: "Smaller ports restrict vessel sizes"
  
  rule: "If vessel DWT > port max DWT capacity → IMPOSSIBLE"
  
  examples:
    major_ports:
      ports: ["Odessa", "Constanta", "Novorossiysk", "Varna", "Burgas", "Batumi"]
      max_capacity: "Up to Panamax (80000 DWT)"
      
    medium_ports:
      ports: ["Crete island"]
      max_capacity: "Up to Handymax (~35000 DWT)"
      
    small_ports_danube:
      ports: ["Reni", "Izmail", "Galati"]
      max_capacity: "Up to small handy (~12000 DWT)"
      restriction: "Draft limited by Danube"
      
  scoring_adjustment:
    - condition: "Vessel size > port capacity"
      score: "IMPOSSIBLE"
      
    - condition: "Vessel size close to port limit (within 10%)"
      penalty: -5
      reason: "Tight fit, operational risk"

# ═══════════════════════════════════════════════════════════════════
# GEOPOLITICAL RESTRICTIONS
# ═══════════════════════════════════════════════════════════════════

geopolitical_blocks:
  
  ukraine_russia_war:
    status: "ACTIVE"
    effective_since: "2022-02-24"
    
    restrictions:
      - description: "Russian vessels CANNOT enter Ukrainian ports"
        reason: "War, sanctions"
        score_impact: "IMPOSSIBLE"
        
      - description: "Vessels in Ukraine CANNOT enter Russian ports"
        reason: "War, sanctions"
        score_impact: "IMPOSSIBLE"
        
      - description: "Russian-flagged vessels restrictions in EU"
        reason: "EU sanctions"
        note: "May affect scoring for EU ports"
    
    future_considerations:
      - "Situation may change"
      - "System must be flexible to update restrictions"
      - "May need temporal logic (restrictions valid from/to dates)"

# ═══════════════════════════════════════════════════════════════════
# USAGE INSTRUCTIONS FOR AI
# ═══════════════════════════════════════════════════════════════════

ai_usage_instructions:
  
  step_1_identify_locations:
    vessel_location:
      - "Determine: Port, Country, Region, Sea, Global Region"
      - "Use Airtable geographic hierarchy"
      - "Refer to vessel_location_determination.txt for logic"
      
    cargo_loading_location:
      - "Determine: Port, Country, Region, Sea, Global Region"
  
  step_2_determine_vessel_size:
    - "Get vessel DWT"
    - "Classify into size category (coaster/small handy/handy/supramax/panamax)"
    - "Select appropriate proximity_scoring table"
  
  step_3_find_proximity_level:
    - "Match vessel location to cargo loading location"
    - "Find the closest matching level"
    - "Get base internal score (0-50 range)"
  
  step_4_apply_adjustments:
    - "Calculate distance in nautical miles (use VesselFinder API if available)"
    - "Apply distance penalty formula"
    - "Check port size restrictions"
    - "Check geopolitical blocks"
    - "Calculate final internal score"
  
  step_5_scale_to_p1_range:
    - "Use formula: P1_final = (internal_score / 50) * 20"
    - "Ensure P1_final is within [0, 20] range"
    - "If internal_score <= 0, P1_final = 0"
  
  step_6_generate_explanation:
    - "Explain which level matched"
    - "Explain any adjustments applied"
    - "Show internal calculation and P1 final score"
    - "Provide reasoning for offer text"
  
  example_process:
    vessel:
      name: "MV EXAMPLE"
      dwt: 7500
      location: "Istanbul, Turkey"
      location_note: "See vessel_location_determination.txt for how to determine this"
      
    cargo:
      loading_port: "Odessa, Ukraine"
      loading_region: "POC"
      loading_sea: "Black Sea"
      
    ai_calculation:
      step_1: "Vessel: Marmara Sea | Cargo: Black Sea POC"
      step_2: "Vessel 7500 DWT = Coaster (4001-17000)"
      step_3: "Match: level_7_marmara_sea → base_internal_score = 20"
      step_4: "Distance ~320nm → penalty 0.96 → adjusted_internal = 19.04"
      step_5: "P1_final = (19.04 / 50) * 20 = 7.6 points"
      step_6: "Generate explanation below"
      
    json_output:
      {
        "criterion_1_proximity": {
          "score": 7.6,
          "score_range": "[0-20]",
          "internal_calculation": "Level 7 (Marmara Sea): 20 internal points - 0.96 distance penalty = 19.04 internal → scaled to 7.6/20 P1",
          "explanation": "Vessel is in Marmara Sea (Istanbul), loading port is Black Sea (Odessa). This is Level 7 proximity for coasters - acceptable ballast through Bosphorus. Distance approximately 320 nautical miles reduces score slightly.",
          "reasoning": "For a 7500 DWT coaster, positioning from Marmara Sea to Black Sea represents moderate ballast economics. The vessel needs to transit the Bosphorus Strait, which is a routine operation. While not optimal, this proximity level is commercially acceptable for the cargo opportunity. The P1 score of 7.6/20 (38%) reflects that ballast costs are manageable but not negligible."
        }
      }

# ═══════════════════════════════════════════════════════════════════
# FUTURE ENHANCEMENTS
# ═══════════════════════════════════════════════════════════════════

future_enhancements:
  - "Integrate VesselFinder API for accurate port-to-port distance calculation"
  - "Add seasonal factors (Bosphorus delays, weather conditions)"
  - "Real-time market conditions (high demand may justify longer ballast)"
  - "Owner preferences (some owners more willing to ballast)"
  - "Fuel prices impact on ballast economics"
  - "Temporal geopolitical restrictions (valid from/to dates)"
  - "Learning from behavioral corrections (adjust levels based on expert feedback)"

# ═══════════════════════════════════════════════════════════════════
# END OF PROXIMITY SCORING MATRIX
# ═══════════════════════════════════════════════════════════════════
